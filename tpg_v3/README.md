TPG version using shared registers, vector and matrix learners